================================================================================
                    NAV2 核心节点依赖与数据流图表 (基于当前配置)
================================================================================

[层级 1: 基础设施层] (底座：没它们 Nav2 节点会一直卡在 Inactive)
--------------------------------------------------------------------------------
- 时钟信号 (/clock): 必须由仿真器提供 (use_sim_time: true)。
- 坐标变换 (TF Tree): 
    * map -> odom     : 由 SLAM 或定位节点提供。
    * odom -> base_link: 由底盘驱动或回环仿真器 (loopback_simulator) 提供。
- 传感器数据 (/seg/scan): 你的配置中所有 Costmap 都订阅这个话题。

[层级 2: 感知与地图层] (输入端)
--------------------------------------------------------------------------------
节点名称              依赖的输入 (Topics/TF)             输出 (供谁使用)
-------------------  ------------------------------  ---------------------------
map_server           硬盘地图文件 (.yaml/.pgm)         /map 话题 (给 static_layer)
global_costmap       TF(map->base), /map, /seg/scan  全局代价地图 (给 Planner)
local_costmap        TF(odom->base), /seg/scan       局部代价地图 (给 Controller)
                     /cloud_obstacles (RTAB-Map)
                     /slam3/map_points (SLAM3)

[层级 3: 计算服务器层] (逻辑核心)
--------------------------------------------------------------------------------
节点名称              依赖的层级/节点                   功能说明
-------------------  ------------------------------  ---------------------------
planner_server       global_costmap                  计算全局路径 (GridBased/Dijkstra)
controller_server    local_costmap                   MPPI 局部避障与路径跟随
smoother_server      planner_server                  平滑路径，减少折线顿挫
behavior_server      global/local_costmap            执行 Spin/Backup 等恢复行为
route_server         Graph 文件 (.geojson)            基于拓扑图的路径路由

[层级 4: 指挥与调度层] (顶层控制)
--------------------------------------------------------------------------------
节点名称              依赖的节点 (Action Clients)      功能说明
-------------------  ------------------------------  ---------------------------
bt_navigator         Planner, Controller, Behavior   行为树大脑，指挥所有 Server
waypoint_follower    bt_navigator                    循环执行多个航点任务

[层级 5: 安全与后处理层] (最后一道防线)
--------------------------------------------------------------------------------
节点名称              依赖的输入                       输出
-------------------  ------------------------------  ---------------------------
velocity_smoother    controller_server (cmd_vel)     平滑后的 cmd_vel (给底盘)
collision_monitor    /seg/scan, TF(odom->base)       紧急刹车指令 (最高优先级)

================================================================================
                    逻辑流向图 (Data & Control Flow)
================================================================================

   [ 传感器/仿真器 ]  --> /seg/scan / /ekf/odom
           |
           v
   +-----------------------+          +------------------------+
   |   local_costmap       |          |    global_costmap      |
   | (盯住周围 4x4m)       |          | (盯住 100x100m 全局)    |
   +----------+------------+          +-----------+------------+
              |                                   |
              v                                   v
   +-----------------------+          +------------------------+
   |   controller_server   | <------- |    planner_server      |
   | (MPPI 驾驶员)         | (路径)    | (Dijkstra 寻路者)      |
   +----------+------------+          +-----------+------------+
              |                                   ^
              v                                   |
   +-----------------------+          +------------------------+
   |   velocity_smoother   | <------- |     bt_navigator       |
   | (油门缓冲)            | (命令)    | (行为树大脑)            |
   +----------+------------+          +------------------------+
              |
              v
   +-----------------------+
   |   collision_monitor   | (强制刹车检查)
   | (主动安全)            |
   +----------+------------+
              |
              +------> [ 机器人电机执行器 ] (/cmd_vel)

================================================================================
提示：你的配置中关键依赖项是 /seg/scan，如果这个话题没有数据，
所有的 Costmap 都无法进入 Active 状态。
================================================================================